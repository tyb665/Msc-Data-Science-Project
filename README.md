# Msc-Data-Science-Project

# 🧠 Earthquake Magnitude Modeling with INLA-SPDE

This project applies **Bayesian spatial and temporal modeling** to earthquake magnitude distributions in California using the **INLA-SPDE framework with inlabru**.  
We estimate spatially varying **b-values**, explore the effect of **depth as a covariate**, and compare modeling strategies across both **synthetic** and **real-world earthquake catalogs**.

---

## 📄 Project Files Overview

### 🔹 Data Preparation
- **`notebooks/Earthquake_data_clean.ipynb`**  
  Python notebook that merges and cleans raw earthquake catalogs (`comcat_catalog.csv` and `earthquakes.csv`).  
  Produces the unified dataset `combined_earthquakes_cleaned.csv`, which is the input for all modeling scripts.

### 🔹 Simulation (Synthetic Data)
- **`scripts/magnitudes_script.R`**  
  Simulates earthquake magnitudes under the Gutenberg–Richter law with **non-clustered events**.  
  Includes:  
  - Exponential sampling of magnitudes  
  - Comparison of Bayesian posterior vs. MLE  
  - Multiple synthetic b-value models (constant, ramp, sinusoidal, Gaussian process)  
  - Model fitting and error metrics (RMSE, MSE)

- **`scripts/magnitude_synth_ETAS.R`**  
  Simulates **clustered earthquake sequences** using the **ETAS model**.  
  Includes:  
  - Posterior estimation of temporal b-values  
  - Pre-/post-mainshock variation analysis  
  - Mesh and prior sensitivity experiments (DIC/WAIC grid search)  
  - Scenario testing (early vs. late mainshocks, event count variation)

### 🔹 Real Data Modeling
- **`scripts/Real_data_script.R`**  
  Exploratory analysis of California catalog (1990–2022).  
  Includes:  
  - Gutenberg–Richter fit  
  - Temporal b(t) modeling with Gaussian process  
  - Spatial b(s) modeling prototype  
  - Introductory figures (time–magnitude plots, spatial distribution)

- **`scripts/Combined_real_data_script.R`**  
  Main **temporal modeling pipeline**.  
  Includes:  
  - Automatic sequence extraction for mainshocks (M ≥ 6.5)  
  - Pre-/post-mainshock b-value comparison  
  - Mesh strategy comparison (uniform, KDE-based, segmented)  
  - Magnitude of completeness (m₀) sensitivity analysis  
  - Prior tuning via DIC/WAIC heatmaps  
  - Depth covariate extension: $\log \beta(t) = \alpha + f(t) + \beta_{\text{depth}} d$

- **`scripts/Combined_real_data_space.R`**  
  Main **spatial modeling pipeline**.  
  Includes:  
  - KDE-weighted mesh construction + quality checks  
  - PC prior calibration (DIC/WAIC search)  
  - Posterior spatial b(s) estimation  
  - Global grid prediction for maps  
  - Depth covariate extension with dual SPDE fields (baseline field + depth-dependent field)  
  - Visualization:  
    - b-value mean map  
    - Posterior SD / credible interval width  
    - Δb (deep − shallow) maps  
    - Depth effect slope maps

---

## 📁 Project Structure

```plaintext
📦 root/
├── 📜 README.md
├── 📁 data/
│   ├── comcat_catalog.csv
│   ├── earthquakes.csv
│   └── combined_earthquakes_cleaned.csv
├── 📁 notebooks/
│   └── Earthquake_data_clean.ipynb
├── 📁 scripts/
│   ├── magnitudes_script.R
│   ├── magnitude_synth_ETAS.R
│   ├── Real_data_script.R
│   ├── Combined_real_data_script.R
│   └── Combined_real_data_space.R
├── 📁 figures/      # Plots and maps generated by scripts
└── 📁 results/      # Model outputs, tables, and posterior summaries



---

## 🚀 How to Run

1. **Prepare Data**  
   Run `notebooks/Earthquake_data_clean.ipynb` to merge raw catalogs and produce `combined_earthquakes_cleaned.csv`.

2. **Simulation Studies**  
   Run `magnitudes_script.R` (non-clustered) and `magnitude_synth_ETAS.R` (clustered) to validate methodology.

3. **Real Data Modeling**  
   - `Real_data_script.R`: Exploratory analysis and initial GR-law fitting.  
   - `Combined_real_data_script.R`: Temporal modeling with mesh, m₀, and depth covariate experiments.  
   - `Combined_real_data_space.R`: Spatial modeling with KDE mesh and depth covariates.

---

## 🧩 Key Features

- 📍 KDE-based mesh sampling for irregular earthquake distributions  
- 🧠 Bayesian INLA-SPDE modeling with uncertainty quantification  
- 📊 Systematic model evaluation using **DIC, WAIC, CPO, PIT**  
- 🔍 Comparative analysis: **MLE vs Bayesian posterior**  
- 🗺️ High-resolution prediction maps of spatial b-values and covariate effects  

---

## 📬 Acknowledgements

- Data: [USGS ComCat](https://earthquake.usgs.gov/data/comcat/)  
- Methodology: [INLA](https://www.r-inla.org/) and [inlabru](https://inlabru-org.github.io/) packages  
- Developed as part of an MSc Data Science dissertation project  
