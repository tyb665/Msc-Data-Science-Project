# Msc-Data-Science-Project

# ğŸ§  Earthquake Magnitude Modeling with INLA-SPDE

This project applies **Bayesian spatial and temporal modeling** to earthquake magnitude distributions in California using the **INLA-SPDE framework with inlabru**.  
We estimate spatially varying **b-values**, explore the effect of **depth as a covariate**, and compare modeling strategies across both **synthetic** and **real-world earthquake catalogs**.

---

## ğŸ“„ Project Files Overview

### ğŸ”¹ Data Preparation
- **`notebooks/Earthquake_data_clean.ipynb`**  
  Python notebook that merges and cleans raw earthquake catalogs (`comcat_catalog.csv` and `earthquakes.csv`).  
  Produces the unified dataset `combined_earthquakes_cleaned.csv`, which is the input for all modeling scripts.

### ğŸ”¹ Simulation (Synthetic Data)
- **`scripts/magnitudes_script.R`**  
  Simulates earthquake magnitudes under the Gutenbergâ€“Richter law with **non-clustered events**.  
  Includes:  
  - Exponential sampling of magnitudes  
  - Comparison of Bayesian posterior vs. MLE  
  - Multiple synthetic b-value models (constant, ramp, sinusoidal, Gaussian process)  
  - Model fitting and error metrics (RMSE, MSE)

- **`scripts/magnitude_synth_ETAS.R`**  
  Simulates **clustered earthquake sequences** using the **ETAS model**.  
  Includes:  
  - Posterior estimation of temporal b-values  
  - Pre-/post-mainshock variation analysis  
  - Mesh and prior sensitivity experiments (DIC/WAIC grid search)  
  - Scenario testing (early vs. late mainshocks, event count variation)

### ğŸ”¹ Real Data Modeling
- **`scripts/Real_data_script.R`**  
  Exploratory analysis of California catalog (1990â€“2022).  
  Includes:  
  - Gutenbergâ€“Richter fit  
  - Temporal b(t) modeling with Gaussian process  
  - Spatial b(s) modeling prototype  
  - Introductory figures (timeâ€“magnitude plots, spatial distribution)

- **`scripts/Combined_real_data_script.R`**  
  Main **temporal modeling pipeline**.  
  Includes:  
  - Automatic sequence extraction for mainshocks (M â‰¥ 6.5)  
  - Pre-/post-mainshock b-value comparison  
  - Mesh strategy comparison (uniform, KDE-based, segmented)  
  - Magnitude of completeness (mâ‚€) sensitivity analysis  
  - Prior tuning via DIC/WAIC heatmaps  
  - Depth covariate extension: $\log \beta(t) = \alpha + f(t) + \beta_{\text{depth}} d$

- **`scripts/Combined_real_data_space.R`**  
  Main **spatial modeling pipeline**.  
  Includes:  
  - KDE-weighted mesh construction + quality checks  
  - PC prior calibration (DIC/WAIC search)  
  - Posterior spatial b(s) estimation  
  - Global grid prediction for maps  
  - Depth covariate extension with dual SPDE fields (baseline field + depth-dependent field)  
  - Visualization:  
    - b-value mean map  
    - Posterior SD / credible interval width  
    - Î”b (deep âˆ’ shallow) maps  
    - Depth effect slope maps

---

## ğŸ“ Project Structure

```plaintext
ğŸ“¦ root/
â”œâ”€â”€ ğŸ“œ README.md
â”œâ”€â”€ ğŸ“ data/
â”‚   â”œâ”€â”€ comcat_catalog.csv
â”‚   â”œâ”€â”€ earthquakes.csv
â”‚   â””â”€â”€ combined_earthquakes_cleaned.csv
â”œâ”€â”€ ğŸ“ notebooks/
â”‚   â””â”€â”€ Earthquake_data_clean.ipynb
â”œâ”€â”€ ğŸ“ scripts/
â”‚   â”œâ”€â”€ magnitudes_script.R
â”‚   â”œâ”€â”€ magnitude_synth_ETAS.R
â”‚   â”œâ”€â”€ Real_data_script.R
â”‚   â”œâ”€â”€ Combined_real_data_script.R
â”‚   â””â”€â”€ Combined_real_data_space.R
â”œâ”€â”€ ğŸ“ figures/      # Plots and maps generated by scripts
â””â”€â”€ ğŸ“ results/      # Model outputs, tables, and posterior summaries



---

## ğŸš€ How to Run

1. **Prepare Data**  
   Run `notebooks/Earthquake_data_clean.ipynb` to merge raw catalogs and produce `combined_earthquakes_cleaned.csv`.

2. **Simulation Studies**  
   Run `magnitudes_script.R` (non-clustered) and `magnitude_synth_ETAS.R` (clustered) to validate methodology.

3. **Real Data Modeling**  
   - `Real_data_script.R`: Exploratory analysis and initial GR-law fitting.  
   - `Combined_real_data_script.R`: Temporal modeling with mesh, mâ‚€, and depth covariate experiments.  
   - `Combined_real_data_space.R`: Spatial modeling with KDE mesh and depth covariates.

---

## ğŸ§© Key Features

- ğŸ“ KDE-based mesh sampling for irregular earthquake distributions  
- ğŸ§  Bayesian INLA-SPDE modeling with uncertainty quantification  
- ğŸ“Š Systematic model evaluation using **DIC, WAIC, CPO, PIT**  
- ğŸ” Comparative analysis: **MLE vs Bayesian posterior**  
- ğŸ—ºï¸ High-resolution prediction maps of spatial b-values and covariate effects  

---

## ğŸ“¬ Acknowledgements

- Data: [USGS ComCat](https://earthquake.usgs.gov/data/comcat/)  
- Methodology: [INLA](https://www.r-inla.org/) and [inlabru](https://inlabru-org.github.io/) packages  
- Developed as part of an MSc Data Science dissertation project  
